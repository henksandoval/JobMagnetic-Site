parameters:
  - name: projectId
    type: string
  - name: pipelineId
    type: string
  - name: runId
    type: string
  - name: artifactName
    type: string
  - name: targetPath
    type: string
  - name: appServiceName
    type: string
  - name: azureResourceServiceConnection
    type: string
  - name: imageRepository
    type: string
  - name: containerRegistry
    type: string
  - name: resourceGroupName
    type: string

steps:
  - task: DownloadPipelineArtifact@2
    displayName: 'Download Build Artifact'
    inputs:
      source: 'specific'
      project: ${{ parameters.projectId }}
      pipeline: ${{ parameters.pipelineId }}
      runVersion: 'specific'
      runId: ${{ parameters.runId }}
      artifactName: ${{ parameters.artifactName }}
      targetPath: ${{ parameters.targetPath }}

  - task: AzureWebAppContainer@1
    displayName: 'Deploy Container to App Service'
    inputs:
      azureSubscription: ${{ parameters.azureResourceServiceConnection }}
      appName: ${{ parameters.appServiceName }}
      resourceGroupName: ${{ parameters.resourceGroupName }}
      imageName: ${{ parameters.containerRegistry }}/${{ parameters.imageRepository }}:$(buildId)
